let rec map ['a 'b||'e] (inv : <'e> -> <'e> -> 'a list -> 'b list -> prop)
  (f : 'a ->{'e} 'b) (l : 'a list) : 'b list {'e} =
  {
    forall s x l l2.
    [[ inv s cur l l2 ]]f x [[ r :  inv s cur (Cons x l) (Cons r l2)]] }
  match l with
  | Nil -> Nil
  | Cons (x,rl) ->
      let r = f x in
      Cons r (map inv f rl)
  end
  {r : inv old cur l r }
