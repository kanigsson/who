logic = ['a||] : (a) -> (a) -> prop
logic /\  : prop -> prop -> prop
logic ->  : prop -> prop -> prop
logic fst ['a1 'b||] : ((a1) * (b)) -> a1
logic snd ['a2 'b1||] : ((a2) * (b1)) -> b1
logic !! ['a3|r|'e] : ref(r,a3) -> <r  'e > -> a3
let
  ! ['a4|r1|] = (fun (x:ref(r1,a4)) ->  parameter(a4,{r1  })
                { r2 : ((!! x cur) = r2) /\ ((!! x old) = (!! x cur))}) 
let pre ['a5 'b2||] = (fun (x1:(a5) * (b2)) -> fst x1) 
let post ['a6 'b3||] = (fun (x2:(a6) * (b3)) -> snd x2) 
logic <=  : int -> int -> prop
logic <  : int -> int -> prop
logic +  : int -> int -> int
logic -  : int -> int -> int
logic int_max  : int -> int -> int
type array['a7||]
logic len ['a8||] : (array[(a8)||]) -> int
logic get ['a9||] : int -> (array[(a9)||]) -> a9
let
  forto [||'e1] = (fun (inv:int -> < 'e1 > -> prop) ->
                  (fun (start:int) ->
                  (fun (end_:int) ->
                  (fun (f:int ->{ 'e1 } unit) ->
                  {(inv start cur1) /\
                   (forall (i:int).
                    ((start <= i) /\ (i <= end_)) ->
                    (forall (m:< 'e1 >).
                     (inv i m) ->
                     ((pre f i m) /\
                      (forall (n:< 'e1 >).
                       (post f i m n ()) -> (inv (i + 1) n)))))}
                  parameter(unit,{ 'e1 })
                  {inv (int_max start (end_ + 1)) cur2})))) 
let
  iter ['a10|t|'e2] = (fun (inv1:<t  'e2 > -> int -> prop) ->
                      (fun (ar:ref(t,array[(a10)||])) ->
                      (fun (f1:(a10) ->{t  'e2 } unit) ->
                      {(inv1 cur3 0) /\
                       (forall (i1:int).
                        ((0 <= i1) /\ (i1 < (len (!! ar cur3)))) ->
                        ([[{inv1 cur4 i1}]]f1 (get i1 (!! ar cur3))[[{
                        inv1 cur5 (i1 + 1)}]]))}
                      let __start = 0 in
                      let __end = (len (! ar)) - 1 in
                      forto ({inv1 cur6 i2}) __start __end (f1
                                                            (get i2 (! ar)))
                      {inv1 cur7 (len (!! ar old1))}))) 
