section basiclogic coq predefined
  pangoline predefined
   logic /\  : prop -> prop -> prop
  logic \/  : prop -> prop -> prop
  logic ->  : prop -> prop -> prop
  logic ~  : prop -> prop
  logic = ['a||] : 'a -> 'a -> prop
  logic <> ['a1||] : 'a1 -> 'a1 -> prop
  logic fst ['a2 'b||] : ('a2 * 'b) -> 'a2
  logic snd ['a3 'b1||] : ('a3 * 'b1) -> 'b1
  logic , ['a4 'b2||] : 'a4 -> 'b2 -> 'a4 * 'b2 end
section arith coq "WhoArith"
  pangoline predefined
   logic +  : int -> int -> int
  logic -  : int -> int -> int
  logic *  : int -> int -> int
  logic <  : int -> int -> prop
  logic <=  : int -> int -> prop
  logic >  : int -> int -> prop
  logic >=  : int -> int -> prop
  logic <<  : int -> int -> bool
  logic <<=  : int -> int -> bool
  logic >>  : int -> int -> bool
  logic >>=  : int -> int -> bool
  logic max  : int -> int -> int
  logic min  : int -> int -> int
  logic mod  : int -> int -> int
  logic band  : bool -> bool -> bool
  logic bor  : bool -> bool -> bool end
logic == ['a5||] : 'a5 -> 'a5 -> bool
logic != ['a6||] : 'a6 -> 'a6 -> bool
section Array coq "WhoArray"
  pangoline takeover
   type array['a13||]
  logic ar_empty ['a14||] : array['a14||]
  logic get ['a15||] : int -> (array['a15||]) -> 'a15
  logic set ['a16||] : int -> 'a16 -> (array['a16||]) -> array['a16||]
  logic len ['a17||] : (array['a17||]) -> int
  logic create ['a18||] : int -> 'a18 -> array['a18||]
  axiom update_length : forall . forall . forall . forall ['a19||]. forall (t:array['a19||]).
                                                                    forall (i2:int).
                                                                    forall (z:'a19).
                                                                    (
                                                                    len ['a19||]
                                                                    t)
                                                                    =[int||]
                                                                    (
                                                                    len ['a19||]
                                                                    (
                                                                    set ['a19||]
                                                                    i2 z t))
  axiom get_set_eq : forall . forall . forall . forall ['a20||]. forall (t1:array['a20||]).
                                                                 forall (i3:int).
                                                                 forall (z1:'a20).
                                                                 (i3 <
                                                                  (len ['a20||]
                                                                   t1))
                                                                 ->
                                                                 ((get ['a20||]
                                                                   i3
                                                                   (set ['a20||]
                                                                    i3 z1 t1))
                                                                  =['a20||]
                                                                  z1)
  axiom length_empty : forall . forall . forall . forall ['a21||]. (len ['a21||]
                                                                    ar_empty ['a21||])
                                                                   =[int||] 0
  axiom get_set_neq : forall . forall . forall . forall ['a22||]. forall (t2:array['a22||]).
                                                                  forall (i4:int).
                                                                  forall (j:int).
                                                                  forall (z2:'a22).
                                                                  (i4 <
                                                                   (len ['a22||]
                                                                    t2))
                                                                  ->
                                                                  ((j <
                                                                    (
                                                                    len ['a22||]
                                                                    t2))
                                                                   ->
                                                                   ((
                                                                    i4
                                                                    <>[int||]
                                                                    j) ->
                                                                    (
                                                                    (
                                                                    get ['a22||]
                                                                    i4
                                                                    (
                                                                    set ['a22||]
                                                                    j z2 t2))
                                                                    =['a22||]
                                                                    (
                                                                    get ['a22||]
                                                                    i4 t2))))
  axiom length_nonnegative : forall . forall . forall . forall ['a23||]. 
    forall (t3:array['a23||]). 0 <= (len ['a23||] t3)
  axiom length_create : forall . forall . forall . forall ['a24||]. forall (l:int).
                                                                    forall (v2:'a24).
                                                                    (
                                                                    0 <= l)
                                                                    ->
                                                                    (
                                                                    (
                                                                    len ['a24||]
                                                                    (
                                                                    create ['a24||]
                                                                    l v2))
                                                                    =[int||]
                                                                    l)
  axiom length_access : forall . forall . forall . forall ['a25||]. forall (i5:int).
                                                                    forall (l1:int).
                                                                    forall (v3:'a25).
                                                                    (
                                                                    0 <= i5)
                                                                    ->
                                                                    (
                                                                    (
                                                                    i5 <= l1)
                                                                    ->
                                                                    (
                                                                    (
                                                                    get ['a25||]
                                                                    i5
                                                                    (
                                                                    create ['a25||]
                                                                    l1 v3))
                                                                    =['a25||]
                                                                    v3)) end
section List coq "WhoList"
  pangoline takeover
   type list['a26||]
  logic nil ['a27||] : list['a27||]
  logic cons ['a28||] : 'a28 -> (list['a28||]) -> list['a28||]
  logic is_nil ['a29||] : (list['a29||]) -> bool
  logic l_in ['a30||] : 'a30 -> (list['a30||]) -> prop end
goal blit_correct : forall . forall . forall ['a31||]. forall (ofs1:int).
                                                       forall (ofs2:int).
                                                       forall (r11:array['a31||]).
                                                       forall (r21:array['a31||]).
                                                       forall (l2:int).
                                                       (0 <= l2) ->
                                                       ((0 <= ofs1) ->
                                                        ((0 <= ofs2) ->
                                                         ((ofs1 <=
                                                           ((len ['a31||] r11)
                                                            - l2))
                                                          ->
                                                          ((ofs2 <=
                                                            ((len ['a31||]
                                                              r21)
                                                             - l2))
                                                           ->
                                                           (((ofs1 < ofs2) ->
                                                             (((forall (r111:array['a31||]).
                                                                forall (r211:array['a31||]).
                                                                forall (i6:int).
                                                                (r111
                                                                 =[array['a31||]||]
                                                                 r11)
                                                                ->
                                                                (((len ['a31||]
                                                                   r211)
                                                                  =[int||]
                                                                  (len ['a31||]
                                                                   r21))
                                                                 ->
                                                                 ((0 <= i6)
                                                                  ->
                                                                  ((i6 <=
                                                                    (
                                                                    (
                                                                    len ['a31||]
                                                                    r21) - 1))
                                                                   ->
                                                                   ((
                                                                    forall (k1:int).
                                                                    (
                                                                    i6 < k1)
                                                                    ->
                                                                    (
                                                                    (
                                                                    k1 <=
                                                                    (
                                                                    (
                                                                    len ['a31||]
                                                                    r21) - 1))
                                                                    ->
                                                                    (
                                                                    (
                                                                    get ['a31||]
                                                                    (
                                                                    ofs2 + k1)
                                                                    r211)
                                                                    =['a31||]
                                                                    (
                                                                    get ['a31||]
                                                                    (
                                                                    ofs1 + k1)
                                                                    r111))))
                                                                    ->
                                                                    (
                                                                    (
                                                                    (
                                                                    r111
                                                                    =[array['a31||]||]
                                                                    r11) /\
                                                                    (
                                                                    (
                                                                    len ['a31||]
                                                                    (
                                                                    set ['a31||]
                                                                    (
                                                                    ofs2 + i6)
                                                                    (
                                                                    get ['a31||]
                                                                    (
                                                                    ofs1 + i6)
                                                                    r111)
                                                                    r211))
                                                                    =[int||]
                                                                    (
                                                                    len ['a31||]
                                                                    r21))) /\
                                                                    (
                                                                    forall (k2:int).
                                                                    (
                                                                    (
                                                                    i6 - 1) <
                                                                    k2) ->
                                                                    (
                                                                    (
                                                                    k2 <=
                                                                    (
                                                                    (
                                                                    len ['a31||]
                                                                    r21) - 1))
                                                                    ->
                                                                    (
                                                                    (
                                                                    get ['a31||]
                                                                    (
                                                                    ofs2 + k2)
                                                                    (
                                                                    set ['a31||]
                                                                    (
                                                                    ofs2 + i6)
                                                                    (
                                                                    get ['a31||]
                                                                    (
                                                                    ofs1 + i6)
                                                                    r111)
                                                                    r211))
                                                                    =['a31||]
                                                                    (
                                                                    get ['a31||]
                                                                    (
                                                                    ofs1 + k2)
                                                                    r111))))))))))
                                                               /\
                                                               ((forall (k:int).
                                                                 (((len ['a31||]
                                                                    r21)
                                                                   - 1)
                                                                  < k)
                                                                 ->
                                                                 ((k <=
                                                                   ((
                                                                    len ['a31||]
                                                                    r21) - 1))
                                                                  ->
                                                                  ((get ['a31||]
                                                                    (
                                                                    ofs2 + k)
                                                                    r21)
                                                                   =['a31||]
                                                                   (get ['a31||]
                                                                    (
                                                                    ofs1 + k)
                                                                    r11))))
                                                                /\
                                                                (forall (i1:int).
                                                                 (0 <= i1) ->
                                                                 ((i1 <=
                                                                   ((
                                                                    len ['a31||]
                                                                    r21) - 1))
                                                                  ->
                                                                  (forall (r112:array['a31||]).
                                                                   forall (r212:array['a31||]).
                                                                   (r112
                                                                    =[array['a31||]||]
                                                                    r11)
                                                                   ->
                                                                   ((
                                                                    (
                                                                    len ['a31||]
                                                                    r212)
                                                                    =[int||]
                                                                    (
                                                                    len ['a31||]
                                                                    r21)) ->
                                                                    (
                                                                    (
                                                                    forall (k11:int).
                                                                    (
                                                                    i1 < k11)
                                                                    ->
                                                                    (
                                                                    (
                                                                    k11 <=
                                                                    (
                                                                    (
                                                                    len ['a31||]
                                                                    r21) - 1))
                                                                    ->
                                                                    (
                                                                    (
                                                                    get ['a31||]
                                                                    (
                                                                    ofs2 +
                                                                    k11) r212)
                                                                    =['a31||]
                                                                    (
                                                                    get ['a31||]
                                                                    (
                                                                    ofs1 +
                                                                    k11) r112))))
                                                                    ->
                                                                    (
                                                                    (
                                                                    (
                                                                    (
                                                                    0 <= i1)
                                                                    /\
                                                                    (
                                                                    i1 <=
                                                                    (
                                                                    (
                                                                    len ['a31||]
                                                                    r21) - 1)))
                                                                    /\
                                                                    (
                                                                    (
                                                                    (
                                                                    r112
                                                                    =[array['a31||]||]
                                                                    r11) /\
                                                                    (
                                                                    (
                                                                    len ['a31||]
                                                                    r212)
                                                                    =[int||]
                                                                    (
                                                                    len ['a31||]
                                                                    r21))) /\
                                                                    (
                                                                    forall (k11:int).
                                                                    (
                                                                    i1 < k11)
                                                                    ->
                                                                    (
                                                                    (
                                                                    k11 <=
                                                                    (
                                                                    (
                                                                    len ['a31||]
                                                                    r21) - 1))
                                                                    ->
                                                                    (
                                                                    (
                                                                    get ['a31||]
                                                                    (
                                                                    ofs2 +
                                                                    k11) r212)
                                                                    =['a31||]
                                                                    (
                                                                    get ['a31||]
                                                                    (
                                                                    ofs1 +
                                                                    k11) r112))))))
                                                                    /\
                                                                    (
                                                                    forall (r113:array['a31||]).
                                                                    forall (r213:array['a31||]).
                                                                    (
                                                                    r113
                                                                    =[array['a31||]||]
                                                                    r11) ->
                                                                    (
                                                                    (
                                                                    (
                                                                    len ['a31||]
                                                                    r213)
                                                                    =[int||]
                                                                    (
                                                                    len ['a31||]
                                                                    r21)) ->
                                                                    (
                                                                    (
                                                                    forall (k21:int).
                                                                    (
                                                                    (
                                                                    i1 - 1) <
                                                                    k21) ->
                                                                    (
                                                                    (
                                                                    k21 <=
                                                                    (
                                                                    (
                                                                    len ['a31||]
                                                                    r21) - 1))
                                                                    ->
                                                                    (
                                                                    (
                                                                    get ['a31||]
                                                                    (
                                                                    ofs2 +
                                                                    k21) r213)
                                                                    =['a31||]
                                                                    (
                                                                    get ['a31||]
                                                                    (
                                                                    ofs1 +
                                                                    k21) r113))))
                                                                    ->
                                                                    (
                                                                    (
                                                                    (
                                                                    r113
                                                                    =[array['a31||]||]
                                                                    r11) /\
                                                                    (
                                                                    (
                                                                    len ['a31||]
                                                                    r213)
                                                                    =[int||]
                                                                    (
                                                                    len ['a31||]
                                                                    r21))) /\
                                                                    (
                                                                    forall (k21:int).
                                                                    (
                                                                    (
                                                                    i1 - 1) <
                                                                    k21) ->
                                                                    (
                                                                    (
                                                                    k21 <=
                                                                    (
                                                                    (
                                                                    len ['a31||]
                                                                    r21) - 1))
                                                                    ->
                                                                    (
                                                                    (
                                                                    get ['a31||]
                                                                    (
                                                                    ofs2 +
                                                                    k21) r213)
                                                                    =['a31||]
                                                                    (
                                                                    get ['a31||]
                                                                    (
                                                                    ofs1 +
                                                                    k21) r113))))))))))))))))
                                                              /\
                                                              (forall (r114:array['a31||]).
                                                               forall (r214:array['a31||]).
                                                               (r114
                                                                =[array['a31||]||]
                                                                r11)
                                                               ->
                                                               (((len ['a31||]
                                                                  r214)
                                                                 =[int||]
                                                                 (len ['a31||]
                                                                  r21))
                                                                ->
                                                                ((forall (k111:int).
                                                                  ((min
                                                                    (
                                                                    (
                                                                    len ['a31||]
                                                                    r21) - 1)
                                                                    (
                                                                    0 - 1))
                                                                   < k111)
                                                                  ->
                                                                  ((k111 <=
                                                                    (
                                                                    (
                                                                    len ['a31||]
                                                                    r21) - 1))
                                                                   ->
                                                                   ((
                                                                    get ['a31||]
                                                                    (
                                                                    ofs2 +
                                                                    k111)
                                                                    r214)
                                                                    =['a31||]
                                                                    (
                                                                    get ['a31||]
                                                                    (
                                                                    ofs1 +
                                                                    k111)
                                                                    r114))))
                                                                 ->
                                                                 (((r11
                                                                    =[array['a31||]||]
                                                                    r114)
                                                                   /\
                                                                   ((
                                                                    len ['a31||]
                                                                    r214)
                                                                    =[int||]
                                                                    (
                                                                    len ['a31||]
                                                                    r21)))
                                                                  /\
                                                                  (forall (k6:int).
                                                                   (0 <= k6)
                                                                   ->
                                                                   ((
                                                                    k6 < l2)
                                                                    ->
                                                                    (
                                                                    (
                                                                    get ['a31||]
                                                                    (
                                                                    ofs2 + k6)
                                                                    r214)
                                                                    =['a31||]
                                                                    (
                                                                    get ['a31||]
                                                                    (
                                                                    ofs1 + k6)
                                                                    r114))))))))))
                                                            /\
                                                            ((~ (ofs1 < ofs2))
                                                             ->
                                                             (((forall (r115:array['a31||]).
                                                                forall (r215:array['a31||]).
                                                                forall (i7:int).
                                                                (r115
                                                                 =[array['a31||]||]
                                                                 r11)
                                                                ->
                                                                (((len ['a31||]
                                                                   r215)
                                                                  =[int||]
                                                                  (len ['a31||]
                                                                   r21))
                                                                 ->
                                                                 ((0 <= i7)
                                                                  ->
                                                                  ((i7 <=
                                                                    (
                                                                    (
                                                                    len ['a31||]
                                                                    r21) - 1))
                                                                   ->
                                                                   ((
                                                                    forall (k4:int).
                                                                    (
                                                                    0 <= k4)
                                                                    ->
                                                                    (
                                                                    (
                                                                    k4 < i7)
                                                                    ->
                                                                    (
                                                                    (
                                                                    get ['a31||]
                                                                    (
                                                                    ofs2 + k4)
                                                                    r215)
                                                                    =['a31||]
                                                                    (
                                                                    get ['a31||]
                                                                    (
                                                                    ofs1 + k4)
                                                                    r115))))
                                                                    ->
                                                                    (
                                                                    (
                                                                    (
                                                                    r115
                                                                    =[array['a31||]||]
                                                                    r11) /\
                                                                    (
                                                                    (
                                                                    len ['a31||]
                                                                    (
                                                                    set ['a31||]
                                                                    (
                                                                    ofs2 + i7)
                                                                    (
                                                                    get ['a31||]
                                                                    (
                                                                    ofs1 + i7)
                                                                    r115)
                                                                    r215))
                                                                    =[int||]
                                                                    (
                                                                    len ['a31||]
                                                                    r21))) /\
                                                                    (
                                                                    forall (k5:int).
                                                                    (
                                                                    0 <= k5)
                                                                    ->
                                                                    (
                                                                    (
                                                                    k5 <
                                                                    (
                                                                    i7 + 1))
                                                                    ->
                                                                    (
                                                                    (
                                                                    get ['a31||]
                                                                    (
                                                                    ofs2 + k5)
                                                                    (
                                                                    set ['a31||]
                                                                    (
                                                                    ofs2 + i7)
                                                                    (
                                                                    get ['a31||]
                                                                    (
                                                                    ofs1 + i7)
                                                                    r115)
                                                                    r215))
                                                                    =['a31||]
                                                                    (
                                                                    get ['a31||]
                                                                    (
                                                                    ofs1 + k5)
                                                                    r115))))))))))
                                                               /\
                                                               ((forall (k3:int).
                                                                 (0 <= k3) ->
                                                                 ((k3 < 0) ->
                                                                  ((get ['a31||]
                                                                    (
                                                                    ofs2 + k3)
                                                                    r21)
                                                                   =['a31||]
                                                                   (get ['a31||]
                                                                    (
                                                                    ofs1 + k3)
                                                                    r11))))
                                                                /\
                                                                (forall (i:int).
                                                                 (0 <= i) ->
                                                                 ((i <=
                                                                   ((
                                                                    len ['a31||]
                                                                    r21) - 1))
                                                                  ->
                                                                  (forall (r116:array['a31||]).
                                                                   forall (r216:array['a31||]).
                                                                   (r116
                                                                    =[array['a31||]||]
                                                                    r11)
                                                                   ->
                                                                   ((
                                                                    (
                                                                    len ['a31||]
                                                                    r216)
                                                                    =[int||]
                                                                    (
                                                                    len ['a31||]
                                                                    r21)) ->
                                                                    (
                                                                    (
                                                                    forall (k31:int).
                                                                    (
                                                                    0 <= k31)
                                                                    ->
                                                                    (
                                                                    (
                                                                    k31 < i)
                                                                    ->
                                                                    (
                                                                    (
                                                                    get ['a31||]
                                                                    (
                                                                    ofs2 +
                                                                    k31) r216)
                                                                    =['a31||]
                                                                    (
                                                                    get ['a31||]
                                                                    (
                                                                    ofs1 +
                                                                    k31) r116))))
                                                                    ->
                                                                    (
                                                                    (
                                                                    (
                                                                    (
                                                                    0 <= i)
                                                                    /\
                                                                    (
                                                                    i <=
                                                                    (
                                                                    (
                                                                    len ['a31||]
                                                                    r21) - 1)))
                                                                    /\
                                                                    (
                                                                    (
                                                                    (
                                                                    r116
                                                                    =[array['a31||]||]
                                                                    r11) /\
                                                                    (
                                                                    (
                                                                    len ['a31||]
                                                                    r216)
                                                                    =[int||]
                                                                    (
                                                                    len ['a31||]
                                                                    r21))) /\
                                                                    (
                                                                    forall (k41:int).
                                                                    (
                                                                    0 <= k41)
                                                                    ->
                                                                    (
                                                                    (
                                                                    k41 < i)
                                                                    ->
                                                                    (
                                                                    (
                                                                    get ['a31||]
                                                                    (
                                                                    ofs2 +
                                                                    k41) r216)
                                                                    =['a31||]
                                                                    (
                                                                    get ['a31||]
                                                                    (
                                                                    ofs1 +
                                                                    k41) r116))))))
                                                                    /\
                                                                    (
                                                                    forall (r117:array['a31||]).
                                                                    forall (r217:array['a31||]).
                                                                    (
                                                                    r117
                                                                    =[array['a31||]||]
                                                                    r11) ->
                                                                    (
                                                                    (
                                                                    (
                                                                    len ['a31||]
                                                                    r217)
                                                                    =[int||]
                                                                    (
                                                                    len ['a31||]
                                                                    r21)) ->
                                                                    (
                                                                    (
                                                                    forall (k51:int).
                                                                    (
                                                                    0 <= k51)
                                                                    ->
                                                                    (
                                                                    (
                                                                    k51 <
                                                                    (
                                                                    i + 1))
                                                                    ->
                                                                    (
                                                                    (
                                                                    get ['a31||]
                                                                    (
                                                                    ofs2 +
                                                                    k51) r217)
                                                                    =['a31||]
                                                                    (
                                                                    get ['a31||]
                                                                    (
                                                                    ofs1 +
                                                                    k51) r117))))
                                                                    ->
                                                                    (
                                                                    (
                                                                    (
                                                                    r117
                                                                    =[array['a31||]||]
                                                                    r11) /\
                                                                    (
                                                                    (
                                                                    len ['a31||]
                                                                    r217)
                                                                    =[int||]
                                                                    (
                                                                    len ['a31||]
                                                                    r21))) /\
                                                                    (
                                                                    forall (k32:int).
                                                                    (
                                                                    0 <= k32)
                                                                    ->
                                                                    (
                                                                    (
                                                                    k32 <
                                                                    (
                                                                    i + 1))
                                                                    ->
                                                                    (
                                                                    (
                                                                    get ['a31||]
                                                                    (
                                                                    ofs2 +
                                                                    k32) r217)
                                                                    =['a31||]
                                                                    (
                                                                    get ['a31||]
                                                                    (
                                                                    ofs1 +
                                                                    k32) r117))))))))))))))))
                                                              /\
                                                              (forall (r118:array['a31||]).
                                                               forall (r218:array['a31||]).
                                                               (r118
                                                                =[array['a31||]||]
                                                                r11)
                                                               ->
                                                               (((len ['a31||]
                                                                  r218)
                                                                 =[int||]
                                                                 (len ['a31||]
                                                                  r21))
                                                                ->
                                                                ((forall (k311:int).
                                                                  (0 <= k311)
                                                                  ->
                                                                  ((k311 <
                                                                    (
                                                                    max 0
                                                                    (
                                                                    (
                                                                    (
                                                                    len ['a31||]
                                                                    r21) - 1)
                                                                    + 1)))
                                                                   ->
                                                                   ((
                                                                    get ['a31||]
                                                                    (
                                                                    ofs2 +
                                                                    k311)
                                                                    r218)
                                                                    =['a31||]
                                                                    (
                                                                    get ['a31||]
                                                                    (
                                                                    ofs1 +
                                                                    k311)
                                                                    r118))))
                                                                 ->
                                                                 (((r11
                                                                    =[array['a31||]||]
                                                                    r118)
                                                                   /\
                                                                   ((
                                                                    len ['a31||]
                                                                    r218)
                                                                    =[int||]
                                                                    (
                                                                    len ['a31||]
                                                                    r21)))
                                                                  /\
                                                                  (forall (k61:int).
                                                                   (0 <= k61)
                                                                   ->
                                                                   ((
                                                                    k61 < l2)
                                                                    ->
                                                                    (
                                                                    (
                                                                    get ['a31||]
                                                                    (
                                                                    ofs2 +
                                                                    k61) r218)
                                                                    =['a31||]
                                                                    (
                                                                    get ['a31||]
                                                                    (
                                                                    ofs1 +
                                                                    k61) r118)))))))))))))))
